<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Mi Perfil - Banco Ucundinamarca</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <div class="section-header" style="margin-top: 20px;">
            <div>
                <h1 id="welcome-message" style="text-align: left;">Hola, ...</h1>
                <p style="color: #666;">Bienvenido a tu banca personal</p>
            </div>
            <a href="#" id="logout-button" class="btn btn-rojo btn-small">Cerrar Sesi√≥n</a>
        </div>

        <div class="layout-dashboard">
            <main>
                <section id="cuentas-section">
                    <div class="section-header">
                        <h3>üí∞ Cuentas de Ahorros</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-info btn-small" onclick="abrirModal('transferir')">Transferir</button>
                            <button class="btn btn-rojo btn-small" onclick="abrirModalRetiro()">- Retirar Dinero</button>
                            <button class="btn btn-secondary btn-small" onclick="abrirModal('cuenta')">+ Crear Nueva</button>
                        </div>
                    </div>
                    <div id="cuentas-container"><p>Cargando...</p></div>
                </section>
                
                <section id="creditos-section" style="margin-top: 30px;">
                    <div class="section-header">
                        <h3>üí∏ Cr√©ditos</h3>
                        <button class="btn btn-secondary btn-small" onclick="abrirModal('credito')">+ Solicitar Cr√©dito</button>
                    </div>
                    <div id="creditos-container"><p>Cargando...</p></div>
                </section>

                <section id="tarjetas-section" style="margin-top: 30px;">
                    <div class="section-header">
                        <h3>üí≥ Tarjetas de Cr√©dito</h3>
                        <button class="btn btn-secondary btn-small" onclick="abrirModal('tarjeta')">+ Solicitar Tarjeta</button>
                    </div>
                    <div id="tarjetas-container"><p>Cargando...</p></div>
                </section>

                <section id="cdts-section" style="margin-top: 30px;">
                    <div class="section-header">
                        <h3>üìà CDTs</h3>
                        <button class="btn btn-secondary btn-small" onclick="abrirModal('cdt')">+ Abrir CDT</button>
                    </div>
                    <div id="cdts-container"><p>Cargando...</p></div>
                </section>
            </main>

            <aside>
                <div class="card" style="text-align: center; position: sticky; top: 20px;">
                    <div class="card-icon" style="font-size: 30px; padding: 20px;">‚≠ê</div>
                    <h3>Estado de tu Cuenta</h3>
                    <div style="margin: 20px 0;">
                        <span id="status-display" class="status-badge">Cargando...</span>
                    </div>
                    <div id="afiliacion-section" style="display: none;">
                        <p style="font-size: 0.9rem;">¬°Convi√©rtete en afiliado para obtener beneficios!</p>
                        <button id="btn-afiliarme" class="btn btn-verde" style="width: 100%;">¬°Quiero ser Afiliado!</button>
                    </div>
                    <p id="message"></p>
                </div>
            </aside>
        </div>
    </div>

    <div id="modal-amortizacion" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="close-amortizacion-btn">&times;</span>
            <h2>Tabla de Amortizaci√≥n</h2>
            <h3 id="cuota-fija-display" style="color: #6d25a8;"></h3>
            <div style="overflow-x: auto; margin-top: 20px;">
                <table id="tabla-amortizacion">
                    <thead><tr><th>Mes</th><th>Cuota</th><th>Inter√©s</th><th>Capital</th><th>Saldo Restante</th></tr></thead>
                    <tbody id="tabla-amortizacion-body"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="form-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="close-form-btn">&times;</span>
            <h2 id="form-modal-title">Solicitud</h2>
            <div id="form-modal-body">
                <form id="form-transferir">
                    <div class="form-group"><label>Desde:</label><select id="transfer-cuenta-origen" class="form-control"></select></div>
                    <div class="form-group"><label>Hacia:</label><select id="transfer-cuenta-destino" class="form-control"></select></div>
                    <div class="form-group"><label>Monto:</label><input type="number" id="transfer-monto" class="form-control"></div>
                </form>
                <form id="form-credito">
                    <div class="form-group"><label>Monto:</label><input type="number" id="credito-monto" class="form-control"></div>
                    <div class="form-group"><label>Plazo:</label><input type="number" id="credito-plazo" class="form-control"></div>
                    <div class="form-group"><label>Tipo:</label><select id="credito-tipo" class="form-control"><option value="LIBRE_INVERSION">Libre Inversi√≥n</option><option value="CARTERA">Cartera</option></select></div>
                </form>
                <form id="form-tarjeta"><div class="form-group"><label>Cupo:</label><input type="number" id="tarjeta-cupo" class="form-control"></div></form>
                <form id="form-cdt">
                    <div class="form-group"><label>Origen:</label><select id="cdt-cuenta-origen" class="form-control"></select></div>
                    <div class="form-group"><label>Monto:</label><input type="number" id="cdt-monto" class="form-control"></div>
                    <div class="form-group"><label>Plazo:</label><input type="number" id="cdt-plazo" class="form-control"></div>
                </form>
                <form id="form-avance">
                    <p id="avance-info"></p>
                    <div class="form-group"><label>Destino:</label><select id="avance-cuenta-destino" class="form-control"></select></div>
                    <div class="form-group"><label>Monto:</label><input type="number" id="avance-monto" class="form-control"></div>
                </form>
                <form id="form-pagar-tarjeta">
                    <p id="pagar-tarjeta-info"></p>
                    <div class="form-group"><label>Origen:</label><select id="pagar-tarjeta-cuenta-origen" class="form-control"></select></div>
                    <div class="form-group"><label>Monto:</label><input type="number" id="pagar-tarjeta-monto" class="form-control"></div>
                </form>

                <p id="modal-error-msg" style="color: red; display:none; font-weight: bold;"></p>
                <button id="modal-submit-btn" class="btn" style="width: 100%; margin-top: 20px;">Confirmar</button>
            </div>
        </div>
    </div>

    <div id="modal-retiro" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="close-retiro-btn">&times;</span>
            <h2>Retirar Dinero</h2>
            <p>Selecciona la cuenta y el monto a retirar.</p>
            
            <div class="form-group">
                <label>Cuenta de Origen:</label>
                <select id="retiro-cuenta-origen" class="form-control"></select>
            </div>
            
            <div class="form-group">
                <label>Monto a Retirar:</label>
                <input type="number" id="retiro-monto" class="form-control" placeholder="Ej: 50000">
            </div>

            <p id="retiro-error-msg" style="color: red; display:none; font-weight: bold;"></p>
            <button id="btn-confirmar-retiro" class="btn btn-rojo" style="width: 100%; margin-top: 20px;">Confirmar Retiro</button>
        </div>
    </div>

    <div id="modal-transacciones" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="close-transacciones-btn">&times;</span>
            <h2 id="transacciones-title">Movimientos</h2>
            <ul id="transaccion-lista"></ul>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/dashboard_cliente.js') }}"></script>
</body>
</html>